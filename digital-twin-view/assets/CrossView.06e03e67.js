import{a7 as e,a5 as t,X as n,a3 as o,r as i,a0 as a,a8 as r,o as l,k as s,ab as u,O as c,P as d,aB as m,W as p,aC as f,aD as h,$ as g,aE as v,aF as C,aA as y,j as w,aj as b,w as T,i as S,aG as k,aH as M,ah as _,af as E,aI as x,aJ as I,aK as L,e as D,aL as F,aM as O,aN as P,aO as B,aP as G,Z as A,aQ as R,ap as W,Y as V,aR as z,f as U,aS as H,aT as $,a4 as N,an as K,h as Y,ak as X,ae as q,aU as j,aV as J,al as Z,ar as Q,as as ee,_ as te,am as ne,l as oe,aW as ie,aX as ae,aY as re,E as le,aZ as se,a_ as ue,a$ as ce,p as de,m as me,b0 as pe,b1 as fe}from"./index.7bee6b1e.js";import{E as he,a as ge,S as ve}from"./sceneViewer.136a5558.js";import{E as Ce,a as ye}from"./index.025fda42.js";const we=(...t)=>n=>{t.forEach((t=>{e(t)?t(n):t.value=n}))};var be=t(n({inheritAttrs:!1}),[["render",function(e,t,n,i,a,r){return o(e.$slots,"default")}],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);var Te=t(n({name:"ElCollectionItem",inheritAttrs:!1}),[["render",function(e,t,n,i,a,r){return o(e.$slots,"default")}],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const Se="data-el-collection-item",ke=e=>{const t=`El${e}Collection`,n=`${t}Item`,o=Symbol(t),c=Symbol(n),d={...be,name:t,setup(){const e=i(null),t=new Map;a(o,{itemMap:t,getItems:()=>{const n=s(e);if(!n)return[];const o=Array.from(n.querySelectorAll(`[${Se}]`));return[...t.values()].sort(((e,t)=>o.indexOf(e.ref)-o.indexOf(t.ref)))},collectionRef:e})}},m={...Te,name:n,setup(e,{attrs:t}){const n=i(null),d=r(o,void 0);a(c,{collectionItemRef:n}),l((()=>{const e=s(n);e&&d.itemMap.set(e,{ref:e,...t})})),u((()=>{const e=s(n);d.itemMap.delete(e)}))}};return{COLLECTION_INJECTION_KEY:o,COLLECTION_ITEM_INJECTION_KEY:c,ElCollection:d,ElCollectionItem:m}},Me=c({style:{type:d([String,Array,Object])},currentTabId:{type:d(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:d(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:_e,ElCollectionItem:Ee,COLLECTION_INJECTION_KEY:xe,COLLECTION_ITEM_INJECTION_KEY:Ie}=ke("RovingFocusGroup"),Le=Symbol("elRovingFocusGroup"),De=Symbol("elRovingFocusGroupItem"),Fe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},Oe=(e,t,n)=>{const o=((e,t)=>{if("rtl"!==t)return e;switch(e){case m.right:return m.left;case m.left:return m.right;default:return e}})(e.key,n);if(!("vertical"===t&&[m.left,m.right].includes(o)||"horizontal"===t&&[m.up,m.down].includes(o)))return Fe[o]},Pe=e=>{const{activeElement:t}=document;for(const n of e){if(n===t)return;if(n.focus(),t!==document.activeElement)return}},Be="currentTabIdChange",Ge="rovingFocusGroup.entryFocus",Ae={bubbles:!1,cancelable:!0},Re=n({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:Me,emits:[Be,"entryFocus"],setup(e,{emit:t}){var n;const o=i(null!=(n=e.currentTabId||e.defaultCurrentTabId)?n:null),l=i(!1),u=i(!1),c=i(null),{getItems:d}=r(xe,void 0),m=p((()=>[{outline:"none"},e.style])),y=C((t=>{var n;null==(n=e.onMousedown)||n.call(e,t)}),(()=>{u.value=!0})),w=C((t=>{var n;null==(n=e.onFocus)||n.call(e,t)}),(e=>{const t=!s(u),{target:n,currentTarget:i}=e;if(n===i&&t&&!s(l)){const e=new Event(Ge,Ae);if(null==i||i.dispatchEvent(e),!e.defaultPrevented){const e=d().filter((e=>e.focusable)),t=[e.find((e=>e.active)),e.find((e=>e.id===s(o))),...e].filter(Boolean).map((e=>e.ref));Pe(t)}}u.value=!1})),b=C((t=>{var n;null==(n=e.onBlur)||n.call(e,t)}),(()=>{l.value=!1}));a(Le,{currentTabbedId:f(o),loop:h(e,"loop"),tabIndex:p((()=>s(l)?-1:0)),rovingFocusGroupRef:c,rovingFocusGroupRootStyle:m,orientation:h(e,"orientation"),dir:h(e,"dir"),onItemFocus:e=>{t(Be,e)},onItemShiftTab:()=>{l.value=!0},onBlur:b,onFocus:w,onMousedown:y}),g((()=>e.currentTabId),(e=>{o.value=null!=e?e:null})),v(c,Ge,((...e)=>{t("entryFocus",...e)}))}});var We=t(n({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:_e,ElRovingFocusGroupImpl:t(Re,[["render",function(e,t,n,i,a,r){return o(e.$slots,"default")}],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group-impl.vue"]])}}),[["render",function(e,t,n,i,a,r){const l=y("el-roving-focus-group-impl"),s=y("el-focus-group-collection");return w(),b(s,null,{default:T((()=>[S(l,k(M(e.$attrs)),{default:T((()=>[o(e.$slots,"default")])),_:3},16)])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group.vue"]]);var Ve=t(n({components:{ElRovingFocusCollectionItem:Ee},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:n,loop:o,onItemFocus:l,onItemShiftTab:u}=r(Le,void 0),{getItems:c}=r(xe,void 0),d=_(),f=i(null),h=C((e=>{t("mousedown",e)}),(t=>{e.focusable?l(s(d)):t.preventDefault()})),g=C((e=>{t("focus",e)}),(()=>{l(s(d))})),v=C((e=>{t("keydown",e)}),(e=>{const{key:t,shiftKey:n,target:i,currentTarget:a}=e;if(t===m.tab&&n)return void u();if(i!==a)return;const r=Oe(e);if(r){e.preventDefault();let t=c().filter((e=>e.focusable)).map((e=>e.ref));switch(r){case"last":t.reverse();break;case"prev":case"next":{"prev"===r&&t.reverse();const e=t.indexOf(a);t=o.value?(s=e+1,(l=t).map(((e,t)=>l[(t+s)%l.length]))):t.slice(e+1);break}}E((()=>{Pe(t)}))}var l,s})),y=p((()=>n.value===s(d)));return a(De,{rovingFocusGroupItemRef:f,tabIndex:p((()=>s(y)?0:-1)),handleMousedown:h,handleFocus:g,handleKeydown:v}),{id:d,handleKeydown:v,handleFocus:g,handleMousedown:h}}}),[["render",function(e,t,n,i,a,r){const l=y("el-roving-focus-collection-item");return w(),b(l,{id:e.id,focusable:e.focusable,active:e.active},{default:T((()=>[o(e.$slots,"default")])),_:3},8,["id","focusable","active"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-item.vue"]]);const ze=c({trigger:x.trigger,effect:{...I.effect,default:"light"},type:{type:d(String)},placement:{type:d(String),default:"bottom"},popperOptions:{type:d(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:d([Number,String]),default:0},maxHeight:{type:d([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:d(Object)},teleported:I.teleported}),Ue=c({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:L}}),He=c({onKeydown:{type:d(Function)}}),$e=[m.down,m.pageDown,m.home],Ne=[m.up,m.pageUp,m.end],Ke=[...$e,...Ne],{ElCollection:Ye,ElCollectionItem:Xe,COLLECTION_INJECTION_KEY:qe,COLLECTION_ITEM_INJECTION_KEY:je}=ke("Dropdown"),Je=Symbol("elDropdown"),{ButtonGroup:Ze}=D;var Qe=t(n({name:"ElDropdown",components:{ElButton:D,ElButtonGroup:Ze,ElScrollbar:F,ElDropdownCollection:Ye,ElTooltip:O,ElRovingFocusGroup:We,ElOnlyChild:P,ElIcon:B,ArrowDown:G},props:ze,emits:["visible-change","click","command"],setup(e,{emit:t}){const n=z(),o=A("dropdown"),{t:r}=R(),l=i(),u=i(),c=i(null),d=i(null),f=i(null),g=i(null),v=i(!1),C=[m.enter,m.space,m.down],y=p((()=>({maxHeight:W(e.maxHeight)}))),w=p((()=>[o.m(k.value)])),b=_().value,T=p((()=>e.id||b));function S(){var e;null==(e=c.value)||e.onClose()}const k=V();a(Je,{contentRef:d,role:p((()=>e.role)),triggerId:T,isUsingKeyboard:v,onItemEnter:function(){},onItemLeave:function(){const e=s(d);null==e||e.focus(),g.value=null}}),a("elDropdown",{instance:n,dropdownSize:k,handleClick:function(){S()},commandHandler:function(...e){t("command",...e)},trigger:h(e,"trigger"),hideOnClick:h(e,"hideOnClick")});return{t:r,ns:o,scrollbar:f,wrapStyle:y,dropdownTriggerKls:w,dropdownSize:k,triggerId:T,triggerKeys:C,currentTabId:g,handleCurrentTabIdChange:function(e){g.value=e},handlerMainButtonClick:e=>{t("click",e)},handleEntryFocus:function(e){v.value||(e.preventDefault(),e.stopImmediatePropagation())},handleClose:S,handleOpen:function(){var e;null==(e=c.value)||e.onOpen()},handleBeforeShowTooltip:function(){t("visible-change",!0)},handleShowTooltip:function(e){"keydown"===(null==e?void 0:e.type)&&d.value.focus()},handleBeforeHideTooltip:function(){t("visible-change",!1)},onFocusAfterTrapped:e=>{var t,n;e.preventDefault(),null==(n=null==(t=d.value)?void 0:t.focus)||n.call(t,{preventScroll:!0})},popperRef:c,contentRef:d,triggeringElementRef:l,referenceElementRef:u}}}),[["render",function(e,t,n,i,a,r){var l;const s=y("el-dropdown-collection"),u=y("el-roving-focus-group"),c=y("el-scrollbar"),d=y("el-only-child"),m=y("el-tooltip"),p=y("el-button"),f=y("arrow-down"),h=y("el-icon"),g=y("el-button-group");return w(),U("div",{class:N([e.ns.b(),e.ns.is("disabled",e.disabled)])},[S(m,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":"hover"===e.trigger?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":null==(l=e.referenceElementRef)?void 0:l.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":"hover"===e.trigger?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},H({content:T((()=>[S(c,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:T((()=>[S(u,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:T((()=>[S(s,null,{default:T((()=>[o(e.$slots,"dropdown")])),_:3})])),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])])),_:3},8,["wrap-style","view-class"])])),_:2},[e.splitButton?void 0:{name:"default",fn:T((()=>[S(d,{id:e.triggerId,role:"button",tabindex:e.tabindex},{default:T((()=>[o(e.$slots,"default")])),_:3},8,["id","tabindex"])]))}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(w(),b(g,{key:0},{default:T((()=>[S(p,$({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:T((()=>[o(e.$slots,"default")])),_:3},16,["size","type","disabled","tabindex","onClick"]),S(p,$({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:T((()=>[S(h,{class:N(e.ns.e("icon"))},{default:T((()=>[S(f)])),_:1},8,["class"])])),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])])),_:3})):K("v-if",!0)],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown.vue"]]);const et=n({name:"DropdownItemImpl",components:{ElIcon:B},props:Ue,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const n=A("dropdown"),{role:o}=r(Je,void 0),{collectionItemRef:i}=r(je,void 0),{collectionItemRef:a}=r(Ie,void 0),{rovingFocusGroupItemRef:l,tabIndex:s,handleFocus:u,handleKeydown:c,handleMousedown:d}=r(De,void 0),f=we(i,a,l),h=p((()=>"menu"===o.value?"menuitem":"navigation"===o.value?"link":"button")),g=C((e=>{const{code:n}=e;if(n===m.enter||n===m.space)return e.preventDefault(),e.stopImmediatePropagation(),t("clickimpl",e),!0}),c);return{ns:n,itemRef:f,dataset:{[Se]:""},role:h,tabIndex:s,handleFocus:u,handleKeydown:g,handleMousedown:d}}}),tt=["aria-disabled","tabindex","role"];const nt=()=>{const e=r("elDropdown",{}),t=p((()=>null==e?void 0:e.dropdownSize));return{elDropdown:e,_elDropdownSize:t}};var ot=t(n({name:"ElDropdownItem",components:{ElDropdownCollectionItem:Xe,ElRovingFocusItem:Ve,ElDropdownItemImpl:t(et,[["render",function(e,t,n,i,a,r){const l=y("el-icon");return w(),U(q,null,[e.divided?(w(),U("li",$({key:0,role:"separator",class:e.ns.bem("menu","item","divided")},e.$attrs),null,16)):K("v-if",!0),Y("li",$({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:t[0]||(t[0]=t=>e.$emit("clickimpl",t)),onFocus:t[1]||(t[1]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onKeydown:t[2]||(t[2]=(...t)=>e.handleKeydown&&e.handleKeydown(...t)),onMousedown:t[3]||(t[3]=(...t)=>e.handleMousedown&&e.handleMousedown(...t)),onPointermove:t[4]||(t[4]=t=>e.$emit("pointermove",t)),onPointerleave:t[5]||(t[5]=t=>e.$emit("pointerleave",t))}),[e.icon?(w(),b(l,{key:0},{default:T((()=>[(w(),b(X(e.icon)))])),_:1})):K("v-if",!0),o(e.$slots,"default")],16,tt)],64)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item-impl.vue"]])},inheritAttrs:!1,props:Ue,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:n}){const{elDropdown:o}=nt(),a=z(),l=i(null),u=p((()=>{var e,t;return null!=(t=null==(e=s(l))?void 0:e.textContent)?t:""})),{onItemEnter:c,onItemLeave:d}=r(Je,void 0),m=C((e=>(t("pointermove",e),e.defaultPrevented)),j((t=>{var n;e.disabled?d(t):(c(t),t.defaultPrevented||null==(n=t.currentTarget)||n.focus())}))),f=C((e=>(t("pointerleave",e),e.defaultPrevented)),j((e=>{d(e)})));return{handleClick:C((n=>{if(!e.disabled)return t("click",n),"keydown"!==n.type&&n.defaultPrevented}),(t=>{var n,i,r;e.disabled?t.stopImmediatePropagation():((null==(n=null==o?void 0:o.hideOnClick)?void 0:n.value)&&(null==(i=o.handleClick)||i.call(o)),null==(r=o.commandHandler)||r.call(o,e.command,a,t))})),handlePointerMove:m,handlePointerLeave:f,textContent:u,propsAndAttrs:p((()=>({...e,...n})))}}}),[["render",function(e,t,n,i,a,r){var l;const s=y("el-dropdown-item-impl"),u=y("el-roving-focus-item"),c=y("el-dropdown-collection-item");return w(),b(c,{disabled:e.disabled,"text-value":null!=(l=e.textValue)?l:e.textContent},{default:T((()=>[S(u,{focusable:!e.disabled},{default:T((()=>[S(s,$(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:T((()=>[o(e.$slots,"default")])),_:3},16,["onPointerleave","onPointermove","onClickimpl"])])),_:3},8,["focusable"])])),_:3},8,["disabled","text-value"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item.vue"]]);const it=n({name:"ElDropdownMenu",props:He,setup(e){const t=A("dropdown"),{_elDropdownSize:n}=nt(),o=n.value,{focusTrapRef:i,onKeydown:a}=r(J,void 0),{contentRef:l,role:u,triggerId:c}=r(Je,void 0),{collectionRef:d,getItems:f}=r(qe,void 0),{rovingFocusGroupRef:h,rovingFocusGroupRootStyle:g,tabIndex:v,onBlur:y,onFocus:w,onMousedown:b}=r(Le,void 0),{collectionRef:T}=r(xe,void 0),S=p((()=>[t.b("menu"),t.bm("menu",null==o?void 0:o.value)])),k=we(l,d,i,h,T),M=C((t=>{var n;null==(n=e.onKeydown)||n.call(e,t)}),(e=>{const{currentTarget:t,code:n,target:o}=e;if(t.contains(o),m.tab===n&&e.stopImmediatePropagation(),e.preventDefault(),o!==s(l))return;if(!Ke.includes(n))return;const i=f().filter((e=>!e.disabled)).map((e=>e.ref));Ne.includes(n)&&i.reverse(),Pe(i)}));return{size:o,rovingFocusGroupRootStyle:g,tabIndex:v,dropdownKls:S,role:u,triggerId:c,dropdownListWrapperRef:k,handleKeydown:e=>{M(e),a(e)},onBlur:y,onFocus:w,onMousedown:b}}}),at=["role","aria-labelledby"];var rt=t(it,[["render",function(e,t,n,i,a,r){return w(),U("ul",{ref:e.dropdownListWrapperRef,class:N(e.dropdownKls),style:Z(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:t[0]||(t[0]=(...t)=>e.onBlur&&e.onBlur(...t)),onFocus:t[1]||(t[1]=(...t)=>e.onFocus&&e.onFocus(...t)),onKeydown:t[2]||(t[2]=(...t)=>e.handleKeydown&&e.handleKeydown(...t)),onMousedown:t[3]||(t[3]=(...t)=>e.onMousedown&&e.onMousedown(...t))},[o(e.$slots,"default")],46,at)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-menu.vue"]]);const lt=Q(Qe,{DropdownItem:ot,DropdownMenu:rt}),st=ee(ot),ut=ee(rt),ct={name:"ScPopover",props:{value:{type:Boolean,default:!1},confirm:{type:Boolean,default:!1},cancel:{type:Boolean,default:!1},title:{default:null},confirmVal:{type:String,default:"确定"},cancelVal:{type:String,default:"取消"},isDisabled:{type:Boolean,default:!1},maskHide:{type:Boolean,default:!0},isMove:{type:Boolean,default:!0},btns:{type:Array,default:null}},mounted(){this.bindDrag()},methods:{maskHandle(){this.maskHide},onConfirm(){this.isDisabled||this.$emit("onConfirm")},onCancel(e){this.$emit("onCancel")},mousedown(e){this.selectElement=this.$refs.box;var t=this.selectElement;this.selectElement.style.cursor="move",this.isDowm=!0;var n=e.clientX-this.selectElement.offsetLeft,o=e.clientY-this.selectElement.offsetTop;this.isMove&&(document.onmousemove=function(i){var a=i||e;t.style.left=a.clientX-n+"px",t.style.top=a.clientY-o+"px",t.style.bottom="auto",t.style.right="auto",a.clientX<=5&&(t.style.left=5-n+"px"),a.clientX>=window.innerWidth&&(t.style.left=window.innerWidth-n+"px"),a.clientY<=40&&(t.style.top=40-o+"px"),a.clientY>=window.innerHeight-30&&(t.style.top=window.innerHeight-30-o+"px")}),document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,t.style.cursor="default"}},bindDrag(){const e=this.$refs.box;let t=document.createElement("div");e.appendChild(t),t.style.cursor="w-resize",t.style.position="absolute",t.style.height="100%",t.style.width="5px",t.style.right="0px",t.style.top="0px",t.onmousedown=t=>{let n=e.clientWidth,o=e.offsetLeft,i=t.clientX;document.onmousemove=function(t){t.preventDefault(),i>o+n-5&&i<o+n&&(i>t.clientX&&(e.clientWidth<200||(e.style.width=n-(i-t.clientX)+"px")),i<t.clientX&&(e.style.width=n+(t.clientX-i)+"px",t.clientX>=window.innerWidth-45&&(e.style.width=n+(window.innerWidth-i)-45+"px")))},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}};let n=document.createElement("div");e.appendChild(n),n.style.cursor="n-resize",n.style.position="absolute",n.style.height="10px",n.style.width="100%",n.style.left="0px",n.style.bottom="0px",n.onmousedown=t=>{let n=e.offsetTop,o=e.scrollTop,i=t.clientY,a=e.clientHeight;document.onmousemove=function(t){t.preventDefault(),o+i>n+a-20&&o+i<n+a&&(i>t.clientY&&(e.clientHeight<300||(e.style.height=a-(i-t.clientY)+"px")),i<t.clientY&&(e.style.height=a+(t.clientY-i)+"px",t.clientY>=window.innerHeight-30&&(e.style.height=a+(window.innerHeight-i)-30+"px")))},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}},btnEvent(e){this.$emit("btnsEvent",e.functionName)}}},dt={class:"Sc-pop-box-body"},mt={class:"Sc-pop-box-body-card Sc-pop-box maxHeight"},pt={class:"Sc-pop-box-unique-foot Sc-pop-box"};const ft=te(ct,[["render",function(e,t,n,i,a,r){const l=y("Edit"),s=D;return w(),U("div",{ref:"box",id:"dragBox",class:N(["Sc-pop-box-unique",{scpopBoxHide:!n.value}])},[Y("div",{class:"Sc-pop-box-unique-head Sc-pop-box",onMousedown:t[1]||(t[1]=(...e)=>r.mousedown&&r.mousedown(...e))},[Y("span",null,ne(n.title),1),Y("span",{type:"close",title:"关闭",class:"Sc-pop-box-unique-close icon-close",onClick:t[0]||(t[0]=(...e)=>r.onCancel&&r.onCancel(...e))},[S(l,{style:{width:"1em",height:"1em","margin-right":"8px"}})])],32),Y("div",dt,[Y("div",mt,[o(e.$slots,"default",{class:"Sc-pop-box"},(()=>[oe("弹窗内容")]),!0)])]),Y("div",pt,[(w(!0),U(q,null,ie(n.btns,(e=>(w(),b(s,{size:"mini",class:"ScpopBtn",key:e.name,onClick:t=>r.btnEvent(e)},{default:T((()=>[oe(ne(e.name),1)])),_:2},1032,["onClick"])))),128)),n.confirm?(w(),b(s,{key:0,size:"mini",class:"ScpopBtn",onClick:r.onConfirm},{default:T((()=>[oe(ne(n.confirmVal),1)])),_:1},8,["onClick"])):K("",!0),n.cancel?(w(),b(s,{key:1,size:"mini",class:"ScpopBtn",onClick:r.onCancel},{default:T((()=>[oe(ne(n.cancelVal),1)])),_:1},8,["onClick"])):K("",!0)])],2)}],["__scopeId","data-v-85372e01"]]),ht={name:"ThreeDService",props:{isOnThreeDService:Boolean},components:{"sc-pop":ft},data(){return{threeDServiceDialogVisible:this.isOnThreeDService,url:"",select:"3Dtiles",positionInfo:"",options:[{value:"3Dtiles",label:"3Dtiles"},{value:"glb",label:"glb"},{value:"gltf",label:"gltf"},{value:"DEM",label:"DEM"}]}},methods:{onCancel(){this.$emit("loadThreeD",!1),this.sceneDialogFormVisible=!1,this.$emit("close")},selectChange(e){this.select=e},addLayer(){if(""!=this.select)if(""!=this.url)switch(this.select){case"3Dtiles":var e=CIM.viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:this.url,maximumScreenSpaceError:64,maximumMemoryUsage:1024,preferLeaves:!0,skipLevelOfDetail:!0}));CIM.viewer.flyTo(e),this.onCancel();break;case"glb":case"gltf":this.loadGlb(this.url,this.positionInfo),this.onCancel();break;case"DEM":CIM.viewer.terrainProvider=new Cesium.CesiumTerrainProvider({url:this.url,requestWaterMask:!0,requestVertexNormals:!0}),CIM.viewer.scene.globe.depthTestAgainstTerrain=!0,this.onCancel();break;case"S3M":CIM.desktop.xycimMap.addS3M(_path,layername,id,{flyTo:!0}),this.onCancel();break;case"I3S":CIM.desktop.xycimMap.addI3S(_path,layername,id,{flyTo:!0}),this.onCancel()}else this.$message.error("请输入服务地址");else this.$message.error("请选择服务类型")},loadGlb(e,t){const n=Cesium.Cartesian3.fromDegrees(t.split(",")[0],t.split(",")[1],t.split(",")[2]),o=Cesium.Math.toRadians(90),i=new Cesium.HeadingPitchRoll(o,0,0),a=Cesium.Transforms.headingPitchRollToFixedFrame(n,i),r=Cesium.Model.fromGltf({url:e,modelMatrix:a,minimumPixelSize:1});CIM.viewer.scene.primitives.add(r);const l=Cesium.Cartesian3.fromDegrees(t.split(",")[0],t.split(",")[1],200);CIM.viewer.camera.flyTo({destination:l,orientation:{heading:Cesium.Math.toRadians(50),pitch:Cesium.Math.toRadians(-90),roll:0}})}}},gt={class:"ThreeDService"},vt={class:"content-box"};const Ct=te(ht,[["render",function(e,t,n,o,i,a){const r=ae,l=re,s=le,u=D,c=y("sc-pop");return w(),U("div",gt,[S(c,{title:"加载三维服务",onOnCancel:a.onCancel,class:"mySettingForm",style:{width:"700px"},modelValue:i.threeDServiceDialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.threeDServiceDialogVisible=e)},{default:T((()=>[Y("div",vt,[S(l,{modelValue:i.select,"onUpdate:modelValue":t[0]||(t[0]=e=>i.select=e),slot:"prepend",placeholder:"请选择",onChange:a.selectChange},{default:T((()=>[(w(!0),U(q,null,ie(i.options,(e=>(w(),b(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),S(s,{placeholder:"请输入服务地址",modelValue:i.url,"onUpdate:modelValue":t[1]||(t[1]=e=>i.url=e),class:"input-with-select"},null,8,["modelValue"]),S(u,{slot:"append",onClick:a.addLayer},{default:T((()=>[oe("加载")])),_:1},8,["onClick"]),"glb"===i.select||"gltf"===i.select?(w(),b(s,{key:0,placeholder:"请输入模型位置，例如：116.135910806103, 24.7034307114178, 1500.0",modelValue:i.positionInfo,"onUpdate:modelValue":t[2]||(t[2]=e=>i.positionInfo=e)},null,8,["modelValue"])):K("",!0)])])),_:1},8,["onOnCancel","modelValue"])])}]]),yt={name:"TwoDService",props:{isOnTwoDService:Boolean},components:{"sc-pop":ft},data(){return{twoDServiceDialogVisible:this.isOnTwoDService,inputimageservice:"",imagename:"",layerType:{},layerTypegroups:[{id:"010100",name:"WMTS",label:"WMTS"},{id:"010200",name:"WMS",label:"WMS"},{id:"010300",name:"WFS",label:"WFS"}],baseSetting:{_layertype:0}}},methods:{onCancel(){this.$emit("loadTwoD",!1),this.twoDServiceDialogVisible=!1,this.$emit("close")},layerType_Change(){this.baseSetting._layertype=this.layerType.id},addWMS(e,t){var n=new Cesium.WebMapServiceImageryProvider({url:e,layers:t,parameters:{service:"WMS",format:"image/png",transparent:!0,maxZoom:22}});CIM.viewer.imageryLayers.addImageryProvider(n),CIM.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(113.13968,22.98968,500)})},addWMTS(){CIM.viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"http://127.0.0.1:64508/twoServe/{z}/{x}/{y}.png",fileExtension:"png"})),CIM.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(116.135910806103,24.7034307114178,1500)})},addLayer(){if(this.layerType!={})if(""!=this.inputimageservice)if(""!=this.imagename)switch(this.layerType.name){case"WMTS":this.addWMTS(),this.onCancel();break;case"WMS":this.addWMS(this.inputimageservice,this.imagename),this.$emit("close"),this.onCancel()}else this.$message.error("请输入服务图层名称");else this.$message.error("请输入服务地址");else this.$message.error("请选择服务类型")}}},wt={class:"TwoDService"},bt={class:"DirectInput"};const Tt=te(yt,[["render",function(e,t,n,o,i,a){const r=ae,l=re,s=Ce,u=he,c=ge,d=le,m=D,p=ye,f=y("sc-pop");return w(),U("div",wt,[S(f,{title:"加载二维服务",onOnCancel:a.onCancel,class:"mySettingForm",style:{width:"700px"},modelValue:i.twoDServiceDialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.twoDServiceDialogVisible=e)},{default:T((()=>[Y("div",bt,[S(p,{ref:"dataForm","label-position":"right","label-width":"100px",size:"small"},{default:T((()=>[S(c,null,{default:T((()=>[S(u,{md:24},{default:T((()=>[S(s,{label:"图层类型"},{default:T((()=>[S(l,{modelValue:i.layerType,"onUpdate:modelValue":t[0]||(t[0]=e=>i.layerType=e),"value-key":"id",class:"SelectorSelect",placeholder:"请选择",onChange:a.layerType_Change},{default:T((()=>[(w(!0),U(q,null,ie(i.layerTypegroups,(e=>(w(),b(r,{key:e.id,label:e.label,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1})])),_:1}),S(c,null,{default:T((()=>[S(u,{md:24},{default:T((()=>[S(s,{label:"服务地址"},{default:T((()=>[S(d,{modelValue:i.inputimageservice,"onUpdate:modelValue":t[1]||(t[1]=e=>i.inputimageservice=e),placeholder:"请输入服务地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(c,null,{default:T((()=>[S(u,{md:24},{default:T((()=>[S(s,{label:"图层名称"},{default:T((()=>[S(d,{modelValue:i.imagename,"onUpdate:modelValue":t[2]||(t[2]=e=>i.imagename=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(c,null,{default:T((()=>[S(u,{md:24},{default:T((()=>[S(m,{onClick:a.addLayer},{default:T((()=>[oe("加载")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},512)])])),_:1},8,["onOnCancel","modelValue"])])}]]);const St={baseLayerArr:[{name:"基础影像",tooltip:"基础影像底图",iconUrl:"../img/googleSatellite.png",category:"底图",mark:!1,creationFunction:function(){return new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",culture:"zh-Hans",mapStyle:Cesium.BingMapsStyle.AERIAL,key:"Al4tDY2MHMXOQpYo7wbSC9ubZLqW5P8uPSCR5sVLE17uUTr6doSgfx5f0Bpgv-FY",minimumLevel:1,maximumLevel:20})}},{name:"夜景影像",tooltip:"基础影像底图",iconUrl:"../img/mapboxnight.png",category:"底图",creationFunction:function(){return new Cesium.MapboxStyleImageryProvider({url:"https://api.mapbox.com/styles/v1",username:"meteornight",styleId:"ckmvg2hdp0hlw17r1272s7lfx",accessToken:"pk.eyJ1IjoiemhhbmdxaW5nbGFuIiwiYSI6ImNsdHNjM3l0NTBwbWIyam8zY2JlNDUzdDYifQ.uXmrgFUtsrojlpIzvHFnSA"})}},{name:"天地图影像",tooltip:"天地图影像底图",iconUrl:"../img/tdtSatellite.png",category:"底图",mark:!0,creationFunction:function(e){return new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=7af1b79cdd1ec59d4eef0892af32a663",layer:"tdtBasicLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!1,minimumLevel:1,maximumLevel:18})}},{name:"天地图矢量",tooltip:"天地图矢量底图",iconUrl:"../img/tdtLight.png",category:"底图",mark:!0,creationFunction:function(e){return new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.com/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=ef6d6d545c900e8dc67b3f4f7dd0c4f5",layer:"tdtBasicLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!1,minimumLevel:1,maximumLevel:18})}}],terrainArr:[{name:"WGS84椭球",iconUrl:"../img/TerrainProviders/WGS84.png",tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",category:"地形",creationFunction:function(){return new Cesium.EllipsoidTerrainProvider}},{name:"世界地形",iconUrl:"../img/TerrainProviders/terrain.png",tooltip:"High-resolution global terrain tileset curated from several datasources and hosted by Cesium ion",category:"地形",creationFunction:function(){return Cesium.createWorldTerrain({requestWaterMask:!0,requestVertexNormals:!0})}},{name:"广州地形",iconUrl:"../img/TerrainProviders/guangzhouTerrain.png",tooltip:"广州DEM",category:"地形",creationFunction:function(){return new Cesium.CesiumTerrainProvider({url:"http://127.0.0.1:64508/DEM/Guangzhou",requestWaterMask:!0,requestVertexNormals:!0})}}],markLayerArr:[{name:"影像注记",tooltip:"天地图影像",iconUrl:"../img/tdtSatellite.png",category:"注记",creationFunction:function(e){return new Cesium.WebMapTileServiceImageryProvider({url:" http://t1.tianditu.com/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=ef6d6d545c900e8dc67b3f4f7dd0c4f5",layer:"tdtMarkLayer",layer:"tdtMarkLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!1,minimumLevel:1,maximumLevel:18})}},{name:"矢量注记",tooltip:"天地图矢量",iconUrl:"../img/tdtLight.png",category:"注记",creationFunction:function(e){var t=new Cesium.WebMapTileServiceImageryProvider({url:" http://t1.tianditu.com/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=ef6d6d545c900e8dc67b3f4f7dd0c4f5",layer:"tdtMarkLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!1,minimumLevel:1,maximumLevel:18});return console.log(t.url),t}}],markConfig:{mark:{"天地图影像":!1,"天地图矢量":!1},display:{"天地图影像":!1,"天地图矢量":!1},layer:{subscript:0,name:""}},baseLayer:{"基础影像":!0,"天地图影像":!1,"天地图矢量":!1,selectedLayer:"基础影像"},terrainLayer:{"椭球平面":!0,"全球地形":!1,selectedLayer:"椭球平面"},setToken:function(e){return setSettingValue("BaseLayerSwitcher_tdt_token",e)},getToken:function(){return getTokenInner()}},kt={props:{isUseMapsChange:Boolean},components:{"sc-pop":ft},data(){return{visible2:!0,visible:this.isUseMapsChange,checked:!1,baseLayerArr:St.baseLayerArr,markConfig:St.markConfig,currentLayer:"",baseLayer:St.baseLayer,terrainLayer:St.terrainLayer,layerStyle:St.layer,terrainArr:St.terrainArr,markLayerArr:St.markLayerArr,isSettingPanel:!1,tdt_token:"8487c77b8410d6c9cd4a22cac7b0d902",vmconfig:St,openMesh:!1,formData:{openContour:!1,contourHeight:5},openThreeDMesh:!1,meshConfig:{heightNum:20,openUnderground:!1,undergroundNum:20},value:"",isOpenThreeMesh:!1}},watch:{visible(e){this.isUseMapsChange=e}},created(){},methods:{show(){this.visible=!0},onCancel(){this.$emit("changeMap",!1),this.visible=!1,console.log("执行"),this.$emit("close")},onCancel1(){this.$emit("close"),this.visible2=!1},changeBaseLayer(e){let t=this;const n=CIM.viewer;t.currentLayer=e.name,n.imageryLayers.removeAll(),t.markConfig.mark[t.markConfig.layer.name]=!1,n.imageryLayers.addImageryProvider(e.creationFunction(t.tdt_token),0),t.markConfig.layer.name=""},changeTerrain(e){CIM.viewer,CIM.viewer.terrainProvider=e.creationFunction(),this.selectedterrianStyle(e.name)},onChange(e){const t=CIM.viewer;let n=this;var o=t.imageryLayers._layers;if(1==n.markConfig.mark[e.name]){""!=n.markConfig.layer.name&&(n.markConfig.mark[n.markConfig.layer.name]=!1),e.name!=n.currentLayer&&n.markConfig.layer.name!=e.name&&(t.imageryLayers.remove(o[0]),t.imageryLayers.addImageryProvider(e.creationFunction(n.tdt_token),0),n.markConfig.layer.name=e.name,n.currentLayer=e.name);for(let i=0;i<n.markLayerArr.length;i++)if(n.markLayerArr[i].tooltip==e.name){let a=n.markLayerArr[i];n.markConfig.layer.subscript=o.length,t.imageryLayers.addImageryProvider(a.creationFunction(n.tdt_token)),n.markConfig.layer.name=e.name;break}}else 0!=n.markConfig.layer.subscript&&(t.imageryLayers.remove(o[n.markConfig.layer.subscript]),n.markConfig.layer.name="")},markShow(e){this.markConfig.display[e]=!0},markHidden(e){this.markConfig.display[e]=!1},selectedBaseStyle:function(e){this.baseLayer[this.baseLayer.selectedLayer]=!1,this.baseLayer[e]=!0,this.baseLayer.selectedLayer=e},selectedterrianStyle:function(e){this.terrainLayer[this.terrainLayer.selectedLayer]=!1,this.terrainLayer[e]=!0,this.terrainLayer.selectedLayer=e},changeMeshEvent(e){window.viewer.scene.globe._surface._tileProvider._debug.wireframe=!0===e},changeEvent(e){!0===e?this.openContour(2,5):this.removeContour()},changeCode(e){1==this.openThreeDMesh&&"beidouCode"==e&&this.openThreeDEntityMesh(this)},changeThreeDEvent(e){!0===e?(this.threeDEntityMesh=!0,"beidouCode"==this.value&&this.openThreeDEntityMesh(this)):threeDEntityMesh.destroy()},changeThreeEvent_openGround(){threeDEntityMesh.changeMeshConfig(this.meshConfig)},openThreeDEntityMesh(e){threeDEntityMesh.openThreeDMeshes(),threeDEntityMesh.changeMeshConfig(this.meshConfig),e.$bus.$on("Selector",(e=>{threeDEntityMesh.changeIsSelector(e)}))},openContour(e,t){let n={};var o=window.viewer.scene.globe,i=Cesium.Material.fromType("ElevationContour");n=i.uniforms,n.width=e,n.spacing=t,n.color=Cesium.Color.RED,o.material=i},removeContour(){window.viewer.scene.globe.material=null},updateContour(){this.openContour(2,this.formData.contourHeight)}}},Mt=e=>(de("data-v-cee17e25"),e=e(),me(),e),_t={class:"baselayer-page"},Et=Mt((()=>Y("dt",{class:"textCss"},[Y("div",{class:"frontstart"}),oe(" 底图 ")],-1))),xt={class:"flex"},It=["onMouseover","onMouseout","onClick"],Lt={class:"layer-main"},Dt={key:0,class:"layer-box"},Ft=Mt((()=>Y("span",{class:"checkbox-span"},"开启注记",-1))),Ot=["onClick"],Pt=["src"],Bt={class:"layer-check-base"},Gt={class:"icon-check-base"},At=Mt((()=>Y("dt",{class:"textCss"},[Y("div",{class:"frontstart"}),oe(" 地形 ")],-1))),Rt={class:"flex"},Wt=["onClick"],Vt={class:"layer-img"},zt=["src"],Ut={class:"layer-check-terrain"},Ht={class:"icon-check-terrain"};const $t=te(kt,[["render",function(e,t,n,o,i,a){const r=se,l=y("sc-pop");return w(),b(l,{title:"地图",onOnCancel:a.onCancel,class:"mySettingForm",modelValue:i.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>i.visible=e)},{default:T((()=>[Y("div",null,[Y("div",_t,[Y("dl",null,[Et,Y("div",xt,[(w(!0),U(q,null,ie(i.baseLayerArr,(e=>(w(),U("dd",{key:e.name,onMouseover:t=>a.markShow(e.name),onMouseout:t=>a.markHidden(e.name),onClick:t=>a.selectedBaseStyle(e.name)},[Y("div",Lt,[1==e.mark?ue((w(),U("div",Dt,[S(r,{modelValue:i.markConfig.mark[e.name],"onUpdate:modelValue":t=>i.markConfig.mark[e.name]=t,onChange:t=>a.onChange(e)},{default:T((()=>[Ft])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])],512)),[[ce,i.markConfig.display[e.name]]]):K("",!0),Y("div",{onClick:t=>a.changeBaseLayer(e),class:"layer-img"},[Y("img",{class:N({"selected-img":i.baseLayer[e.name]}),src:e.iconUrl,alt:"item.name"},null,10,Pt),ue(Y("div",Bt,null,512),[[ce,i.baseLayer[e.name]]]),ue(Y("div",Gt,null,512),[[ce,i.baseLayer[e.name]]])],8,Ot)]),Y("p",{class:N({"selected-font":i.baseLayer[e.name]})},ne(e.name),3)],40,It)))),128))])]),Y("dl",null,[At,Y("div",Rt,[(w(!0),U(q,null,ie(i.terrainArr,(e=>(w(),U("dd",{key:e.name,onClick:t=>a.changeTerrain(e)},[Y("div",Vt,[Y("img",{class:N({"selected-img":i.terrainLayer[e.name]}),src:e.iconUrl,alt:"item.name"},null,10,zt),ue(Y("div",Ut,null,512),[[ce,i.terrainLayer[e.name]]]),ue(Y("div",Ht,null,512),[[ce,i.terrainLayer[e.name]]])]),Y("p",{class:N({"selected-font":i.terrainLayer[e.name]})},ne(e.name),3)],8,Wt)))),128))])])])])])),_:1},8,["onOnCancel","modelValue"])}],["__scopeId","data-v-cee17e25"]]);class Nt{constructor(){}initMeasureTool(e,t={}){e&&e instanceof Cesium.Viewer&&(this._drawLayer=new Cesium.CustomDataSource("measureLayer"),e&&e.dataSources.add(this._drawLayer),this._basePath=t.basePath||"",this._viewer=e)}transformWGS84ToCartesian(e,t){if(this._viewer)return e?Cesium.Cartesian3.fromDegrees(e.lng||e.lon,e.lat,e.alt=t||e.alt,Cesium.Ellipsoid.WGS84):Cesium.Cartesian3.ZERO}transformWGS84ArrayToCartesianArray(e,t){if(this._viewer&&e){var n=this;return e?e.map((function(e){return n.transformWGS84ToCartesian(e,t)})):[]}}transformCartesianToWGS84(e){if(this._viewer&&e){var t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(e);return{lng:Cesium.Math.toDegrees(t.longitude),lat:Cesium.Math.toDegrees(t.latitude),alt:t.height}}}transformCartesianArrayToWGS84Array(e){if(this._viewer){var t=this;return e?e.map((function(e){return t.transformCartesianToWGS84(e)})):[]}}transformWGS84ToCartographic(e){return e?Cesium.Cartographic.fromDegrees(e.lng||e.lon,e.lat,e.alt):Cesium.Cartographic.ZERO}getCatesian3FromPX(e){if(this._viewer&&e){var t=this._viewer.scene.drillPick(e),n=null,o=!1,i=!1;for(let i in t){let a=t[i];if((a&&a.primitive instanceof Cesium.Cesium3DTileFeature||a&&a.primitive instanceof Cesium.Cesium3DTileset||a&&a.primitive instanceof Cesium.Model)&&(o=!0),o&&(this._viewer.scene.pick(e),n=this._viewer.scene.pickPosition(e))){let e=Cesium.Cartographic.fromCartesian(n);e.height<0&&(e.height=0);let t=Cesium.Math.toDegrees(e.longitude),o=Cesium.Math.toDegrees(e.latitude),i=e.height;n=this.transformWGS84ToCartesian({lng:t,lat:o,alt:i})}}let r=this._viewer.terrainProvider instanceof Cesium.EllipsoidTerrainProvider;if(!o&&!r){var a=this._viewer.scene.camera.getPickRay(e);if(!a)return null;n=this._viewer.scene.globe.pick(a,this._viewer.scene),i=!0}if(o||i||!r||(n=this._viewer.scene.camera.pickEllipsoid(e,this._viewer.scene.globe.ellipsoid)),n){let e=this.transformCartesianToWGS84(n);return e.alt<0&&(n=this.transformWGS84ToCartesian(e,.1)),n}return!1}}getPositionDistance(e){let t=0;for(let n=0;n<e.length-1;n++){let o=this.transformWGS84ToCartographic(e[n]),i=this.transformWGS84ToCartographic(e[n+1]),a=new Cesium.EllipsoidGeodesic;a.setEndPoints(o,i);let r=a.surfaceDistance;r=Math.sqrt(Math.pow(r,2)+Math.pow(i.height-o.height,2)),t+=r}return t.toFixed(3)}getPositionsArea(e){let t=0;if(e){let n=0,o=Cesium.Ellipsoid.WGS84;e.push(e[0]);for(let t=1;t<e.length;t++){let i=o.cartographicToCartesian(this.transformWGS84ToCartographic(e[t-1])),a=o.cartographicToCartesian(this.transformWGS84ToCartographic(e[t]));n+=i.x*a.y-a.x*i.y}t=Math.abs(n).toFixed(2)}return t}drawPointMeasureGraphics(e={}){if(this._viewer&&e){let e=function(e){var t=new Cesium.Entity;t.position=e,t.point={pixelSize:10,outlineColor:Cesium.Color.BLUE,outlineWidth:5};var n=o.transformCartesianToWGS84(e).lng.toFixed(6),i=o.transformCartesianToWGS84(e).lat.toFixed(6);t.label={text:"纬度："+i+"\n经度："+n,show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,-80)},o._drawLayer.entities.add(t)};var t=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas),n=[];new Cesium.Entity;var o=this;t.setInputAction((function(i){t.destroy(),t=null;var a=o.getCatesian3FromPX(i.position);a&&a.x&&(0==n.length&&n.push(a.clone()),e(a),n.push(a))}),Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction((function(e){var t=o.getCatesian3FromPX(e.endPosition);n.length>=2&&t&&t.x&&(n.pop(),n.push(t))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)}}drawLineMeasureGraphics(e={}){if(this._viewer&&e){let r=function(e){var t=new Cesium.Entity;t.position=e,t.point={pixelSize:10,outlineColor:Cesium.Color.BLUE,outlineWidth:5},t.label={text:(a.getPositionDistance(a.transformCartesianArrayToWGS84Array(o))/1e3).toFixed(4)+"公里",show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,-60)},a._drawLayer.entities.add(t)};var t,n=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas),o=[],i=new Cesium.Entity,a=this;n.setInputAction((function(e){var t=a.getCatesian3FromPX(e.position);t&&t.x&&(0==o.length&&o.push(t.clone()),r(t),o.push(t))}),Cesium.ScreenSpaceEventType.LEFT_CLICK),n.setInputAction((function(e){var t=a.getCatesian3FromPX(e.endPosition);o.length>=2&&t&&t.x&&(o.pop(),o.push(t))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),n.setInputAction((function(i){n.destroy(),n=null;let l=a.getCatesian3FromPX(i.position);r(l),"function"==typeof e.callback&&e.callback(a.transformCartesianArrayToWGS84Array(o),t)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),i.polyline={width:e.width||5,material:e.material||Cesium.Color.BLUE.withAlpha(.8),clampToGround:e.clampToGround||!1},i.polyline.positions=new Cesium.CallbackProperty((function(){return o}),!1),t=this._drawLayer.entities.add(i)}}drawAreaMeasureGraphics(e){if(this._viewer&&e){let l=function(){i.polyline={width:3,material:Cesium.Color.BLUE.withAlpha(.8),clampToGround:e.clampToGround||!1},i.polyline.positions=new Cesium.CallbackProperty((function(){return n}),!1),i.polygon={hierarchy:new Cesium.CallbackProperty((function(){return o}),!1),material:Cesium.Color.WHITE.withAlpha(.1),clampToGround:e.clampToGround||!1},r=a._drawLayer.entities.add(i)},s=function(e){var t=new Cesium.Entity;t.position=e,t.point={pixelSize:10,outlineColor:Cesium.Color.BLUE,outlineWidth:5},t.label={text:(a.getPositionsArea(a.transformCartesianArrayToWGS84Array(n))/1e6).toFixed(4)+"平方公里",show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,-40)},a._drawLayer.entities.add(t)};var t=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas),n=[],o=new Cesium.PolygonHierarchy,i=new Cesium.Entity,a=this,r=null;t.setInputAction((function(e){var t=a.getCatesian3FromPX(e.position);t&&t.x&&(0==n.length&&(o.positions.push(t.clone()),n.push(t.clone())),n.push(t.clone()),o.positions.push(t.clone()),r||l())}),Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction((function(e){var t=a.getCatesian3FromPX(e.endPosition);n.length>=2&&t&&t.x&&(n.pop(),n.push(t),o.positions.pop(),o.positions.push(t))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction((function(o){a.getCatesian3FromPX(o.endPosition),t.destroy(),n.push(n[0]),s(n[0]),"function"==typeof e.callback&&e.callback(a.transformCartesianArrayToWGS84Array(n),r)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)}}drawTrianglesMeasureGraphics(e={}){if(e.style=e.style||{width:3,material:Cesium.Color.BLUE.withAlpha(.5)},this._viewer&&e){let u=function(e,t){if(!e&&!t)return 0;if(Cesium.Cartesian3.equals(e,t))return 0;let n=Cesium.Cartographic.fromCartesian(e);return(Cesium.Cartographic.fromCartesian(t).height-n.height).toFixed(2)},c=function(e){let t=Cesium.Cartographic.fromCartesian(e[0]),n=Cesium.Cartographic.fromCartesian(e[1]);return Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(t.longitude),Cesium.Math.toDegrees(t.latitude),n.height)};var t=new Cesium.Entity,n=new Cesium.Entity,o=new Cesium.Entity,i=[],a=[],r=[],l=this,s=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);s.setInputAction((function(r){var u=l.getCatesian3FromPX(r.position);if(!u&&!u.z)return!1;0==i.length?(i.push(u.clone()),i.push(u.clone()),a.push(u.clone()),a.push(u.clone())):(s.destroy(),"function"==typeof e.callback&&e.callback({e:t,e2:n,e3:o}))}),Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction((function(e){var t=l.getCatesian3FromPX(e.endPosition);if(t&&i.length>0){i.pop(),i.push(t.clone());let e=c(i);a.pop(),a.push(e.clone()),r.pop(),r.pop(),r.push(t.clone()),r.push(e.clone())}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.polyline={positions:new Cesium.CallbackProperty((function(){return i}),!1),...e.style},t.position=new Cesium.CallbackProperty((function(){return i[0]}),!1),t.point={pixelSize:5,outlineColor:Cesium.Color.BLUE,outlineWidth:5},t.label={text:new Cesium.CallbackProperty((function(){return"直线:"+l.getPositionDistance(l.transformCartesianArrayToWGS84Array(i))+"米"}),!1),show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(50,-100)},n.polyline={positions:new Cesium.CallbackProperty((function(){return a}),!1),...e.style},n.position=new Cesium.CallbackProperty((function(){return r[1]}),!1),n.point={pixelSize:5,outlineColor:Cesium.Color.BLUE,outlineWidth:5},n.label={text:new Cesium.CallbackProperty((function(){return"高度:"+u(a[0],a[1])+"米"}),!1),show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,100)},o.polyline={positions:new Cesium.CallbackProperty((function(){return r}),!1),...e.style},o.position=new Cesium.CallbackProperty((function(){return i[1]}),!1),o.point={pixelSize:5,outlineColor:Cesium.Color.BLUE,outlineWidth:5},o.label={text:new Cesium.CallbackProperty((function(){return"水平距离:"+l.getPositionDistance(l.transformCartesianArrayToWGS84Array(r))+"米"}),!1),show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-150,-20)},this._drawLayer.entities.add(o),this._drawLayer.entities.add(n),this._drawLayer.entities.add(t)}}}const Kt={class:"cesium-tool-container"},Yt={class:"cesium-tools"},Xt=te({__name:"CesiumToolNav",setup(e){l((()=>{}));const t=e=>{switch(e){case"changeMap":o(!0);break;case"threeDService":r(!0);break;case"twoDService":u(!0);break;case"startMeasure":console.log("开始测量"),c.initMeasureTool(CIM.viewer);break;case"pointMeasure":c.drawPointMeasureGraphics({clampToGround:!0,callback:()=>{}});break;case"lineMeasure":c.drawLineMeasureGraphics({clampToGround:!0,callback:()=>{}});break;case"areaMeasure":c.drawAreaMeasureGraphics({clampToGround:!0,callback:()=>{}});break;case"clearMeasure":c._drawLayer.entities.removeAll();break;case"draw":m()}},n=i(!1);function o(e){n.value=e}const a=i(!1);function r(e){a.value=e}const s=i(!1);function u(e){s.value=e}const c=new Nt,d=i(!1),m=()=>{d.value=!d.value};return(e,i)=>{const l=D,c=st,p=ut,f=lt,h=ge;return w(),U("div",Kt,[Y("div",Yt,[S(h,null,{default:T((()=>[S(f,{onCommand:t},{dropdown:T((()=>[S(p,null,{default:T((()=>[S(c,{command:"changeMap"},{default:T((()=>[oe("切换地图")])),_:1}),S(c,{command:"threeDService"},{default:T((()=>[oe("三维服务")])),_:1}),S(c,{command:"twoDService"},{default:T((()=>[oe("二维服务")])),_:1})])),_:1})])),default:T((()=>[S(l,{type:"primary"},{default:T((()=>[oe("开始")])),_:1})])),_:1}),S(f,{onCommand:t},{dropdown:T((()=>[S(p,null,{default:T((()=>[S(c,{command:"startMeasure"},{default:T((()=>[oe("开始测量")])),_:1}),S(c,{command:"pointMeasure"},{default:T((()=>[oe("坐标拾取")])),_:1}),S(c,{command:"lineMeasure"},{default:T((()=>[oe("测距")])),_:1}),S(c,{command:"areaMeasure"},{default:T((()=>[oe("测面积")])),_:1}),S(c,{command:"clearMeasure"},{default:T((()=>[oe("清除测量")])),_:1}),S(c,{command:"draw"},{default:T((()=>[oe("矢量绘制")])),_:1}),S(c,{command:"locationEdit"},{default:T((()=>[oe("位置调整")])),_:1})])),_:1})])),default:T((()=>[S(l,{type:"primary"},{default:T((()=>[oe("基本功能")])),_:1})])),_:1}),S(f,{onCommand:t},{dropdown:T((()=>[S(p,{slot:"dropdown"},{default:T((()=>[S(c,{command:"addFlyCzml"},{default:T((()=>[oe("全场景漫游")])),_:1}),S(c,{command:"addPersonCzml"},{default:T((()=>[oe("一层人员漫游")])),_:1}),S(c,{command:"unlock"},{default:T((()=>[oe("漫游场景解锁")])),_:1})])),_:1})])),default:T((()=>[S(l,{type:"primary"},{default:T((()=>[oe("场景浏览")])),_:1})])),_:1}),S(f,{onCommand:t},{dropdown:T((()=>[S(p,{slot:"dropdown"},{default:T((()=>[S(c,{command:"onTilesInspector"},{default:T((()=>[oe("三维性能")])),_:1}),S(c,{command:"changeGlobel"},{default:T((()=>[oe("地球透明")])),_:1})])),_:1})])),default:T((()=>[S(l,{type:"primary"},{default:T((()=>[oe("基础设置")])),_:1})])),_:1})])),_:1}),ue(S($t,{isUseMapsChange:n.value,onChangeMap:o},null,8,["isUseMapsChange"]),[[ce,n.value]]),ue(S(Ct,{isOnThreeDService:a.value,onLoadThreeD:r},null,8,["isOnThreeDService"]),[[ce,a.value]]),ue(S(Tt,{isOnTwoDService:s.value,onLoadTwoD:u},null,8,["isOnTwoDService"]),[[ce,s.value]]),ue(S(pe,{ref:"drawViewer",onCloseEvent:m},null,512),[[ce,d.value]])])])}}},[["__scopeId","data-v-9d55b9bc"]]),qt=e=>(de("data-v-91538f45"),e=e(),me(),e),jt={class:"root-container"},Jt=qt((()=>Y("div",{id:"cross-map-container"},null,-1))),Zt={id:"latlng_show"},Qt={style:{width:"150px",height:"30px",float:"left"}},en=qt((()=>Y("span",{id:"longitude_show"},null,-1))),tn={style:{width:"150px",height:"30px",float:"left"}},nn=qt((()=>Y("span",{id:"latitude_show"},null,-1))),on={style:{width:"150px",height:"30px",float:"left"}},an=qt((()=>Y("span",{id:"altitude_show"},null,-1))),rn=te({__name:"CrossView",setup(e){l((()=>{t(),n()}));const t=()=>{const e=(new ve).createViewer("cross-map-container",{});var t={};t.defaultResetView=Cesium.Rectangle.fromDegrees(113.450809,23.17754,113.45081,23.17754),t.enableCompass=!0,t.enableZoomControls=!0,t.enableDistanceLegend=!0,t.enableCompassOuterRing=!0,fe(e,t),CIM.viewer=e},n=()=>{const e=CIM.viewer;let t=document.getElementById("longitude_show"),n=document.getElementById("latitude_show"),o=document.getElementById("altitude_show");const i=e.scene;let a;i.pickPositionSupported||window.alert("This browser does not support pickPosition."),a=new Cesium.ScreenSpaceEventHandler(i.canvas),a.setInputAction((function(a){const r=e.camera.pickEllipsoid(a.endPosition,i.globe.ellipsoid);if(r){const i=Cesium.Cartographic.fromCartesian(r),a=Cesium.Math.toDegrees(i.longitude).toFixed(8),l=Cesium.Math.toDegrees(i.latitude).toFixed(8),s=(e.camera.positionCartographic.height/1e3).toFixed(2);t.innerHTML=a,n.innerHTML=l,o.innerHTML=s}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)};return(e,t)=>{const n=y("font");return w(),U("div",jt,[Jt,Y("div",Zt,[Y("div",Qt,[S(n,{size:"2",color:"white"},{default:T((()=>[oe(" 经度："),en])),_:1})]),Y("div",tn,[S(n,{size:"2",color:"white"},{default:T((()=>[oe(" 纬度："),nn])),_:1})]),Y("div",on,[S(n,{size:"2",color:"white"},{default:T((()=>[oe(" 视角高："),an,oe("米 ")])),_:1})])]),S(Xt)])}}},[["__scopeId","data-v-91538f45"]]);export{rn as default};
